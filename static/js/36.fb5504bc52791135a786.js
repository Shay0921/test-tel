webpackJsonp([36],{"Q/FG":function(e,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var t=a("mvHQ"),l=a.n(t),o=a("NZyr"),r={data:function(){return{smsActiveName:"first",searchSmsRecord:{input:"",date:"",task:""},taskOp:[{value:"1",label:"客户咨询"},{value:"2",label:"客户邀约"}],smsRecordTableData:[{id:1,company:"北京海硅信息技术有限公司",phone:"135****3159",scene:"挂机短信",task:"客户咨询",mould:"二次跟进",state:"1",date:"2018-11-07 10:00:56"},{id:2,company:"北京海硅信息技术有限公司",phone:"135****3159",scene:"挂机短信",task:"客户咨询",mould:"二次跟进",state:"2",date:"2018-11-07 10:00:56"},{id:3,company:"北京海硅信息技术有限公司",phone:"135****3159",scene:"挂机短信",task:"客户咨询",mould:"二次跟进",state:"1",date:"2018-11-07 10:00:56"}],smsRecordTotal:150,smsRecordCurrentPage:2,smsRecordPageSize:100,delVisible:!1,showAddSmsTask:!1,searchSmsTask:{name:"",state:"",date:""},taskStateOp:[{value:"1",label:"进行中"},{value:"2",label:"已完成"},{value:"3",label:"发送失败"}],addSmsTaskTitle:"新建短信任务",multipleSelection:[],smsTaskTableData:[{id:1,taskName:"有意向客户短信",progress:"1",creator:"shay",state:"1",date:"2018-11-07 10:00:56"},{id:2,taskName:"有意向客户短信",progress:"1",creator:"shay",state:"2",date:"2018-11-07 10:00:56"},{id:2,taskName:"有意向客户短信",progress:"1",creator:"shay",state:"3",date:"2018-11-07 10:00:56"}],smsTaskAddForm:{start:1,taskName:"",date:"",time:[new Date,new Date],mould:"",file:[]},smsTaskAddRules:{taskName:[{required:!0,message:"请输入任务名称",trigger:"blur"}],date:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}],time:[{type:"array",required:!0,message:"请选择时间",trigger:"change"}],mould:[{required:!0,message:"请选择模板",trigger:"change"}]},mouldOp:[{value:1,label:"模板1"},{value:2,label:"模板2"}],smsTaskTotal:150,smsTaskCurrentPage:2,smsTaskPageSize:100}},methods:{handleClickSms:function(e,s){},changeSearchSmsRecord:function(){var e=JSON.parse(l()(this.searchSmsRecord.input));this.searchSmsRecord={input:e,task:"",date:""}},changeSmsRecordTask:function(e){this.searchSmsRecord.input=""},changeSmsRecordDate:function(e){this.searchSmsRecord.input=""},smsRecordHandleSizeChange:function(e){},smsRecordHandleCurrentChange:function(e){},handleSelectTask:function(e){this.multipleSelection=e},changeSearchSmsTask:function(){var e=JSON.parse(l()(this.searchSmsTask.name));this.searchSmsTask={name:e,state:"",date:""}},changeSmsTaskTask:function(e){this.searchSmsTask.name=""},changeSmsTaskDate:function(e){this.searchSmsTask.name=""},refreshBtn:function(){this.searchSmsTask={name:"",state:"",date:""},this.$message.success("刷新成功"),this.$refs.smsTaskTable.clearSelection()},clickDelCheckTask:function(){var e=this;if(this.multipleSelection.length>0){var s=[];this.multipleSelection.forEach(function(e,a){s.push(e.id)}),this.smsTaskTableData=this.smsTaskTableData.filter(function(s){return-1===e.multipleSelection.indexOf(s)}),this.$refs.smsTaskTable.clearSelection(),this.$message.success("删除成功")}else this.$message.error("请先选择需要删除的任务")},clickDelSmsTask:function(e,s){s.splice(e,1),this.$message.success("删除成功")},clickshowTask:function(e,s){this.showAddSmsTask=!0,"add"===e?(this.addSmsTaskTitle="新建短信任务",this.smsTaskAddForm={start:1,taskName:"",date:"",time:[new Date,new Date],mould:"",file:[]}):(this.addSmsTaskTitle="编辑短信任务",this.smsTaskAddForm=JSON.parse(l()(s)))},addSmsTaskTab:function(e,s){var a="/AISmsTaskItem/"+s;Object(o.c)(a,e,"")},closeSmsTaskModal:function(e){this.showAddSmsTask=!1,this.$refs[e].resetFields()},submitSmsTaskBtn:function(){var e=this;this.$refs.smsTaskAddForm.validate(function(s){if(s)if(0===e.$refs.complexUpload.uploadFiles.length)e.$message.warning("请上传文件");else{var a=JSON.parse(l()(e.smsTaskAddForm));1===a.start&&(a.date=Object(o.e)(new Date(a.date)),a.time=[Object(o.f)(new Date(a.time[0])),Object(o.f)(new Date(a.time[1]))]);var t=new FormData,r=e.$refs.complexUpload.uploadFiles[0].raw;t.append("file",r),"新建短信任务"===e.addSmsTaskTitle?(e.smsTaskTableData.push(a),e.$message.success("新建成功")):e.smsTaskTableData.forEach(function(s,t){a.id===s.id&&(e.$set(e.smsTaskTableData,t,a),e.$message.success("修改成功"))}),e.closeSmsTaskModal("smsTaskAddForm")}})},clickComplexDownload:function(){var e=document.createElement("a");e.download="批量导入模板",e.style.display="none",e.href="../../../static/image/批量导入模板.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)},handleComplexBefore:function(e,s){var a="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.raw.type||"application/vnd.ms-excel"===e.raw.type;return a?(s.length>1&&s.splice(0,1),a):(s.length>1?s.splice(1,1):s.splice(0,1),this.$message.warning("请上传csv或xlsx格式的文件"),!1)},smsTaskHandleSizeChange:function(e){},smsTaskHandleCurrentChange:function(e){},delPopover:o.d}},n={render:function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("div",{staticClass:"sms haigui-section"},[a("el-tabs",{on:{"tab-click":e.handleClickSms},model:{value:e.smsActiveName,callback:function(s){e.smsActiveName=s},expression:"smsActiveName"}},[a("el-tab-pane",{staticClass:"smsTask",attrs:{label:"短信任务",name:"first"}},[a("div",{staticClass:"smsItem-title"},[a("el-input",{attrs:{placeholder:"搜索任务名称"},on:{input:e.changeSearchSmsTask},model:{value:e.searchSmsTask.name,callback:function(s){e.$set(e.searchSmsTask,"name",s)},expression:"searchSmsTask.name"}}),e._v(" "),a("el-select",{attrs:{placeholder:"请选择任务状态",clearable:""},on:{change:e.changeSmsTaskTask},model:{value:e.searchSmsTask.state,callback:function(s){e.$set(e.searchSmsTask,"state",s)},expression:"searchSmsTask.state"}},e._l(e.taskStateOp,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeSmsTaskDate},model:{value:e.searchSmsTask.date,callback:function(s){e.$set(e.searchSmsTask,"date",s)},expression:"searchSmsTask.date"}}),e._v(" "),a("div",{staticClass:"smsItem-btn"},[a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.delVisible,callback:function(s){e.delVisible=s},expression:"delVisible"}},[a("p",[e._v("是否删除选中的任务？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(s){e.delVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){e.delVisible=!1,e.clickDelCheckTask()}}},[e._v("确定")])],1),e._v(" "),a("el-button",{staticStyle:{padding:"9px","margin-left":"10px"},attrs:{slot:"reference",icon:"el-icon-delete"},on:{click:function(s){e.delVisible=!e.delVisible}},slot:"reference"},[e._v("删除")])],1),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{icon:"el-icon-refresh"},on:{click:e.refreshBtn}},[e._v("刷新")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(s){e.clickshowTask("add")}}},[e._v("新建短信任务")])],1)],1),e._v(" "),a("el-table",{ref:"smsTaskTable",staticStyle:{width:"100%"},attrs:{data:e.smsTaskTableData},on:{"selection-change":e.handleSelectTask}},[a("el-table-column",{attrs:{width:"20"}}),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"短信任务名称","show-overflow-tooltip":"","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(s){return[a("span",{staticClass:"clickCell",on:{click:function(a){e.addSmsTaskTab(s.row.taskName,s.row.id)}}},[e._v(e._s(s.row.taskName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"进度","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(s){return[a("span",[e._v("进度"+e._s(s.row.progress)+"/1")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"creator",label:"创建者","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(s){return[a("span",{domProps:{textContent:e._s("1"===s.row.state?"进行中":"2"===s.row.state?"已完成":"发送失败")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"date",label:"创建时间","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(s){return[a("el-button",{attrs:{type:"text"},on:{click:e.clickComplexDownload}},[e._v("导出任务结果")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.clickshowTask("edit",s.row)}}},[e._v("编辑")]),e._v(" "),a("el-popover",{attrs:{"popper-class":"smsTaskPopover"+s.row.id,placement:"top",width:"160"},model:{value:s.row.visible,callback:function(a){e.$set(s.row,"visible",a)},expression:"scope.row.visible"}},[a("p",[e._v("确定删除此任务吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){s.row.visible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){s.row.visible=!1,e.clickDelSmsTask(s.$index,e.smsTaskTableData)}}},[e._v("确定")])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},on:{click:function(a){a.stopPropagation(),s.row.visible=!s.row.visible,e.delPopover("smsTask",s.row.id)}},slot:"reference"},[e._v("删除")])],1)]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.smsTaskCurrentPage,"page-sizes":[100,200,300,400],"page-size":e.smsTaskPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.smsTaskTotal},on:{"size-change":e.smsTaskHandleSizeChange,"current-change":e.smsTaskHandleCurrentChange}})],1),e._v(" "),a("el-tab-pane",{staticClass:"smsRecord",attrs:{label:"短信记录",name:"sccond"}},[a("div",{staticClass:"smsItem-title"},[a("el-input",{attrs:{placeholder:"搜索短信记录","prefix-icon":"el-icon-search"},on:{input:e.changeSearchSmsRecord},model:{value:e.searchSmsRecord.input,callback:function(s){e.$set(e.searchSmsRecord,"input",s)},expression:"searchSmsRecord.input"}}),e._v(" "),a("el-select",{attrs:{placeholder:"请选择任务名称",clearable:""},on:{change:e.changeSmsRecordTask},model:{value:e.searchSmsRecord.task,callback:function(s){e.$set(e.searchSmsRecord,"task",s)},expression:"searchSmsRecord.task"}},e._l(e.taskOp,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeSmsRecordDate},model:{value:e.searchSmsRecord.date,callback:function(s){e.$set(e.searchSmsRecord,"date",s)},expression:"searchSmsRecord.date"}})],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.smsRecordTableData}},[a("el-table-column",{attrs:{width:"20"}}),e._v(" "),a("el-table-column",{attrs:{prop:"company",label:"客户名称","show-overflow-tooltip":"","min-width":"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机号","min-width":"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"scene",label:"发送场景","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"task",label:"任务名称","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mould",label:"模板名称","show-overflow-tooltip":"","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{label:"发送状态","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(s){return[a("span",{domProps:{textContent:e._s("1"===s.row.state?"发送成功":"发送失败")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"date",label:"发送时间","min-width":"150"}})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.smsRecordCurrentPage,"page-sizes":[100,200,300,400],"page-size":e.smsRecordPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.smsRecordTotal},on:{"size-change":e.smsRecordHandleSizeChange,"current-change":e.smsRecordHandleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{width:"500px",title:e.addSmsTaskTitle,visible:e.showAddSmsTask},on:{"update:visible":function(s){e.showAddSmsTask=s},close:function(s){e.closeSmsTaskModal("smsTaskAddForm")}}},[a("el-form",{ref:"smsTaskAddForm",attrs:{model:e.smsTaskAddForm,rules:e.smsTaskAddRules,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"启动方式",prop:"start"}},[a("el-radio-group",{model:{value:e.smsTaskAddForm.start,callback:function(s){e.$set(e.smsTaskAddForm,"start",s)},expression:"smsTaskAddForm.start"}},[a("el-radio-button",{attrs:{label:1}},[e._v("定时启动")]),e._v(" "),a("el-radio-button",{attrs:{label:2}},[e._v("手动启动")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"任务名称",prop:"taskName"}},[a("el-input",{attrs:{maxlength:30,placeholder:"请输入任务名称"},model:{value:e.smsTaskAddForm.taskName,callback:function(s){e.$set(e.smsTaskAddForm,"taskName",s)},expression:"smsTaskAddForm.taskName"}})],1),e._v(" "),1===e.smsTaskAddForm.start?a("div",{},[a("el-form-item",{attrs:{label:"启动日期",prop:"date"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.smsTaskAddForm.date,callback:function(s){e.$set(e.smsTaskAddForm,"date",s)},expression:"smsTaskAddForm.date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"启动时间",prop:"time"}},[a("el-time-picker",{attrs:{"is-range":"","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.smsTaskAddForm.time,callback:function(s){e.$set(e.smsTaskAddForm,"time",s)},expression:"smsTaskAddForm.time"}})],1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"选择短信模版",prop:"mould"}},[a("el-select",{attrs:{placeholder:"请选择短信模板"},model:{value:e.smsTaskAddForm.mould,callback:function(s){e.$set(e.smsTaskAddForm,"mould",s)},expression:"smsTaskAddForm.mould"}},e._l(e.mouldOp,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(e){}}},[e._v("点此新建模板")])],1),e._v(" "),a("el-form-item",{attrs:{label:"发送对象"}},[a("el-upload",{ref:"complexUpload",staticClass:"upload-demo",attrs:{action:"","on-change":e.handleComplexBefore,"auto-upload":!1,"file-list":e.smsTaskAddForm.file}},[a("el-button",{attrs:{type:"primary",size:"small"}},[e._v("点击上传文件")])],1),e._v(" "),a("el-button",{attrs:{size:"small",type:"text"},on:{click:e.clickComplexDownload}},[e._v("点击下载Excel模板")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(s){e.closeSmsTaskModal("smsTaskAddForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitSmsTaskBtn}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(r,n,!1,function(e){a("de65")},null,null);s.default=i.exports},de65:function(e,s){}});