webpackJsonp([22],{GEfl:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),i=a.n(s),r=a("sqkR"),n=a("8VoQ"),o=a("DyVN"),l={data:function(){return{showOverlay:!1,filterData:{},delVisible:!1,getVisible:!1,showTransferModal:!1,transferModalForm:{tab:"first",checkFirstNode:[],checkIdShow:[],checkSecondNode:[],firstTotal:"",firstFactTotal:"",secondTotal:""},multipleSelection:[],checkId:[],seaTableData:[{id:1,company:"北京海硅信息技术有限公司1",name:"刘欣雨1",avatar:"../../../static/image/avatar_gray.jpg",phone:"18211103898",stage:"1",update:"2018-10-20 17:00",follower:"刘欣雨",updateContent:"添加跟进记录： 意向客户 拜访 成交",date:"2018-10-20",tag:[{color:"#409EFF",text:"已拨通"},{color:"#F56C6C",text:"A类客户"}],remind:{remindDate:"2011-01-01 11:11:11",remindContent:"第一个",remindClass:"1",remindRangeKey:[11,77],remindRangeNode:[{id:11,label:"shay"},{id:77,label:"qq"}]}},{id:2,company:"北京海硅信息技术有限公司2",name:"刘欣雨2",avatar:"../../../static/image/avatar_gray.jpg",phone:"18211103898",stage:"2",update:"2018-10-20 17:00",follower:"刘欣雨",updateContent:"添加跟进记录： 意向客户 拜访 成交",date:"2018-10-20",tag:[{color:"#409EFF",text:"已拨通"},{color:"#F56C6C",text:"A类客户"}],remind:{remindDate:"2011-01-01 11:11:11",remindContent:"第一个",remindClass:"1",remindRangeKey:[22,77],remindRangeNode:[{id:22,label:"刘欣雨"},{id:77,label:"qq"}]}},{id:3,company:"北京海硅信息技术有限公司3",name:"刘欣雨3",avatar:"../../../static/image/avatar_gray.jpg",phone:"18211103898",stage:"3",update:"2018-10-20 17:00",follower:"刘欣雨",updateContent:"添加跟进记录： 意向客户 拜访 成交",date:"2018-10-20",tag:[{color:"#409EFF",text:"已拨通"},{color:"#F56C6C",text:"A类客户"}],remind:{remindDate:"2013-01-01 11:11:11",remindContent:"第一个",remindClass:"1",remindRangeKey:[33,44],remindRangeNode:[{id:33,label:"成员1"},{id:44,label:"成员2"}]}}],CRMSeaTotal:1500,CRMSeaCurrentPage:2,CRMSeaPageSize:100,showSlider:!1,clickSliderObj:{id:"",index:""}}},watch:{multipleSelection:function(e){var t=this;this.checkId=[],this.multipleSelection.forEach(function(e,a){t.checkId.push(e.id)})},"transferModalForm.checkFirstNode":function(e,t){var a=e.filter(function(e){return-1===t.indexOf(e)});a.forEach(function(e,t){e.count=0}),this.changeTransferNumber()}},computed:{CRMSeaPage:function(){return Math.ceil(this.CRMSeaTotal/this.CRMSeaPageSize)},averageNumber:function(){var e={allot:0,quotient:0};if(this.showTransferModal){var t=0,a=this.checkId.length;e=this.transferModalForm.checkSecondNode&&(t=this.transferModalForm.checkSecondNode.length)>0?{allot:a%t,quotient:parseInt(a/t)}:{allot:0,quotient:0}}return e}},methods:{submitAddCustomer:function(e){this.seaTableData.push(e),this.$message.success("新建成功")},getFilterData:function(e){this.filterData=e},refreshBtn:function(){this.$message.success("刷新成功"),this.$refs.seaTable.clearSelection()},clickDelCheckSea:function(){var e=this;this.multipleSelection.length>0?(this.seaTableData=this.seaTableData.filter(function(t){return-1===e.multipleSelection.indexOf(t)}),this.$refs.seaTable.clearSelection(),this.$message.success("删除成功")):this.$message.error("请先选择需要删除的客户")},clickGetCheckSea:function(){var e=this;this.multipleSelection.length>0?(this.seaTableData=this.seaTableData.filter(function(t){return-1===e.multipleSelection.indexOf(t)}),this.$refs.seaTable.clearSelection(),this.$message.success("领取成功")):this.$message.error("请先选择需要领取的客户")},clickAllotSea:function(){this.checkId.length>0?(this.transferModalForm={tab:"first",checkFirstNode:[],checkIdShow:[],checkSecondNode:[],firstTotal:this.checkId.length,firstFactTotal:this.checkId.length,secondTotal:this.checkId.length},this.showTransferModal=!0):this.$message.error("请先选择需要分配的客户")},closeTransferModal:function(){this.showTransferModal=!1},handleClickTransferModalTab:function(e,t){},changeTransferNumber:function(){var e=this.transferModalForm,t=this.checkId.length,a=this.checkId.length;e.checkFirstNode.forEach(function(e,s){var i=e.count;void 0===i&&(i=0),a-=i,(t-=i)<=0&&(t=0)}),this.transferModalForm.firstTotal=t,this.transferModalForm.firstFactTotal=a},clickDelTrasferMember:function(e){var t=this.transferModalForm.checkFirstNode;t.forEach(function(a,s){a.id===e&&(a.count=0,t.splice(s,1))}),this.transferModalForm.checkIdShow=t,this.changeTransferNumber()},submitTransferModal:function(){var e=JSON.parse(i()(this.transferModalForm));"first"===e.tab?e.firstFactTotal===this.checkId.length?this.$message.error("请填写分配数量"):e.firstFactTotal<0?this.$message.error("填写数量已超过分配条数"):(this.$message.success("分配成功"),this.closeTransferModal()):this.transferModalForm.checkSecondNode.length>0?this.averageNumber.quotient>0?(this.$message.success("分配成功"),this.closeTransferModal()):this.$message.error("选中的人数超过需要分配的数量"):this.$message.error("请先选择需要分配的成员")},CRMSeaChangeCurrent:function(e){"next"===e?++this.CRMSeaCurrentPage:--this.CRMSeaCurrentPage},handleSelectSea:function(e){this.multipleSelection=e},sortChangeSea:function(e,t,a){"ascending"===e.order?this.$message.success("升序"):"descending"===e.order?this.$message.success("降序"):this.$message.success("还原")},clickTableAITask:function(e){this.checkId=[e],this.showAIModal=!0},CRMSeaHandleSizeChange:function(e){},CRMSeaHandleCurrentChange:function(e){this.CRMSeaCurrentPage=e},clickTableItem:function(e,t){this.showSlider=!0,this.clickSliderObj={id:e.id,index:this.getRowData("seaTableData",e.id)}},getRowData:function(e,t){for(var a=0;a<this[e].length;a++){if(this[e][a].id===t)return a}},delIndexChild:function(e){this.seaTableData.splice(e,1)}},components:{"v-CRMComponent":r.a,"v-memberCheckboxTree":n.a,"v-CRMSlider":o.a}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"haigui-section CRMSeaList scrollbar"},[a("v-CRMComponent",{attrs:{page:"CRMSeaList"},on:{addCustomer:e.submitAddCustomer,sendFilter:e.getFilterData}}),e._v(" "),a("div",{staticClass:"CRMSea-app"},[a("p",[e._v("共"+e._s(e.CRMSeaTotal)+"人，已选择"+e._s(e.multipleSelection.length)+"人")]),e._v(" "),a("div",{staticClass:"CRMSea-app-btn"},[a("div",{},[a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.delVisible,callback:function(t){e.delVisible=t},expression:"delVisible"}},[a("p",[e._v("是否删除选中的客户？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.delVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.delVisible=!1,e.clickDelCheckSea()}}},[e._v("确定")])],1),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{slot:"reference",icon:"el-icon-delete"},on:{click:function(t){e.delVisible=!e.delVisible}},slot:"reference"},[e._v("删除")])],1),e._v(" "),a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refreshBtn}},[e._v("刷新")]),e._v(" "),a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.getVisible,callback:function(t){e.getVisible=t},expression:"getVisible"}},[a("p",[e._v("确认领取吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.getVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.getVisible=!1,e.clickGetCheckSea()}}},[e._v("确定")])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"primary"},on:{click:function(t){e.getVisible=!e.getVisible}},slot:"reference"},[e._v("领取")])],1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.clickAllotSea}},[e._v("分配")])],1),e._v(" "),a("div",{staticClass:"CRMSea-app-btn-right"},[a("el-button",{attrs:{icon:"el-icon-arrow-right",disabled:e.CRMSeaCurrentPage===e.CRMSeaPage},on:{click:function(t){e.CRMSeaChangeCurrent("next")}}}),e._v(" "),a("el-button",{attrs:{icon:"el-icon-arrow-left",disabled:1===e.CRMSeaCurrentPage},on:{click:function(t){e.CRMSeaChangeCurrent("prev")}}}),e._v(" "),a("span",[e._v(e._s(e.CRMSeaCurrentPage)+"/"+e._s(e.CRMSeaPage))])],1)])]),e._v(" "),a("div",{staticClass:"CRMSeaList-table"},[a("el-table",{ref:"seaTable",staticStyle:{width:"100%"},attrs:{data:e.seaTableData},on:{"sort-change":e.sortChangeSea,"row-click":e.clickTableItem,"selection-change":e.handleSelectSea}},[a("el-table-column",{attrs:{width:"20"}}),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{label:"客户名称","show-overflow-tooltip":"","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{staticClass:"clickCell"},[e._v(e._s(t.row.company))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"联系人","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"right",width:"230",trigger:"hover"}},[a("div",{staticClass:"seaTable-info"},[a("div",{},[a("img",{attrs:{src:t.row.avatar,alt:""}}),e._v(" "),a("div",{staticStyle:{float:"left"}},[a("p",{staticStyle:{"font-size":"14px"}},[e._v(e._s(t.row.name))]),e._v(" "),a("p",{staticStyle:{"font-size":"14px"}},[e._v(e._s(t.row.phone)),a("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"text"}},[e._v("添加")]),a("el-button",{attrs:{type:"text"}},[e._v("编辑")])],1)])])]),e._v(" "),a("p",{staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"跟进阶段","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"1"===t.row.stage?"success":"warning"},domProps:{textContent:e._s("1"===t.row.stage?"新入库":"有意向")}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"跟进动态","show-overflow-tooltip":"",sortable:"custom","min-width":"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.update))]),e._v(" "),a("p",[e._v(e._s(t.row.updateContent))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"follower",label:"最后跟进人","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"date",label:"创建时间","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"tag",label:"客户标签","show-overflow-tooltip":"","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.tag,function(t,s){return a("el-tag",{key:s,staticStyle:{color:"#fff","margin-right":"5px"},attrs:{color:t.color},domProps:{textContent:e._s(t.text)}})})}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.CRMSeaCurrentPage,"page-sizes":[100,200,300,400],"page-size":e.CRMSeaPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.CRMSeaTotal},on:{"size-change":e.CRMSeaHandleSizeChange,"current-change":e.CRMSeaHandleCurrentChange}})],1),e._v(" "),a("el-dialog",{staticClass:"customerTransferModal",attrs:{width:"700px",title:"分配",visible:e.showTransferModal},on:{"update:visible":function(t){e.showTransferModal=t},close:e.closeTransferModal}},[a("el-tabs",{on:{"tab-click":e.handleClickTransferModalTab},model:{value:e.transferModalForm.tab,callback:function(t){e.$set(e.transferModalForm,"tab",t)},expression:"transferModalForm.tab"}},[a("el-tab-pane",{attrs:{label:"直接分配",name:"first"}},[a("div",{staticClass:"left"},[a("h6",[e._v("组织架构")]),e._v(" "),a("v-memberCheckboxTree",{attrs:{show:e.showTransferModal,"check-node":e.transferModalForm.checkFirstNode,"check-show":e.transferModalForm.checkIdShow},on:{"update:checkNode":function(t){e.$set(e.transferModalForm,"checkFirstNode",t)},"update:checkShow":function(t){e.$set(e.transferModalForm,"checkIdShow",t)}}})],1),e._v(" "),a("div",{staticClass:"right"},[a("p",[e._v("待分配数据："),a("b",[e._v(e._s(e.transferModalForm.firstTotal))]),e._v("条")]),e._v(" "),a("div",{staticClass:"table scrollbar"},[a("div",{staticClass:"table-header"},[a("p",[e._v("姓名")]),e._v(" "),a("p",[e._v("电话")]),e._v(" "),a("p",[e._v("角色")]),e._v(" "),a("p",[e._v("分配数量")]),e._v(" "),a("p")]),e._v(" "),a("div",{staticClass:"table-body"},e._l(e.transferModalForm.checkFirstNode,function(t,s){return a("div",{staticClass:"table-tr"},[a("p",[e._v(e._s(t.label))]),e._v(" "),a("p",[e._v(e._s(t.phone))]),e._v(" "),a("p",[e._v(e._s(t.role))]),e._v(" "),a("p",[a("el-input-number",{attrs:{min:0,controls:!1,size:"mini"},on:{change:e.changeTransferNumber},model:{value:t.count,callback:function(a){e.$set(t,"count",a)},expression:"item.count"}})],1),e._v(" "),a("p",[a("i",{staticClass:"el-icon-delete",on:{click:function(a){e.clickDelTrasferMember(t.id)}}})])])}))])])]),e._v(" "),a("el-tab-pane",{attrs:{label:"平均分配",name:"second"}},[a("div",{staticClass:"left"},[a("h6",[e._v("组织架构")]),e._v(" "),a("v-memberCheckboxTree",{attrs:{show:e.showTransferModal,"check-node":e.transferModalForm.checkSecondNode},on:{"update:checkNode":function(t){e.$set(e.transferModalForm,"checkSecondNode",t)}}})],1),e._v(" "),a("div",{staticClass:"right"},[a("p",{staticStyle:{"padding-top":"60px","text-align":"center"}},[e._v("待分配数据："),a("b",[e._v(e._s(e.transferModalForm.secondTotal))]),e._v("条")]),e._v(" "),a("p",{staticStyle:{"padding-top":"40px","text-align":"center"}},[e._v("已选"),a("b",{domProps:{textContent:e._s(e.transferModalForm.checkSecondNode?e.transferModalForm.checkSecondNode.length:0)}}),e._v("人，每人分配"),a("b",[e._v(e._s(e.averageNumber.quotient))]),e._v("条，剩余"),a("b",[e._v(e._s(e.averageNumber.allot))]),e._v("条")])])])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.closeTransferModal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitTransferModal}},[e._v("确 定")])],1)],1),e._v(" "),a("v-CRMSlider",{attrs:{visible:e.showSlider,sliderObj:e.clickSliderObj,pageType:"show"},on:{"update:visible":function(t){e.showSlider=t},sendIndex:e.delIndexChild}})],1)},staticRenderFns:[]};var d=a("VU/8")(l,c,!1,function(e){a("lQ4P")},null,null);t.default=d.exports},lQ4P:function(e,t){}});